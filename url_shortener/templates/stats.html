{% extends 'base.html' %}

{% block section %}

<div class="stats">
	<table class="table table-hover table-striped table-bordered">
		<caption>Stats for all Short URLs Generated</caption>
		<thead class="thead-light">
			<tr>
				<th scope="col">Long URL</th>
				<th scope="col">Short URL</th>
				<th scope="col">Hits</th>
			</tr>
		</thead>
	
		<tbody>
			{% for obj in url %}
			<tr>
				<td>{{ obj['long_url']['S'] }}</td>
				<td><a href="{{domain}}{{ obj['short_url']['S'] }}" target="_blank"> /{{ obj['short_url']['S'] }}</a></td>
				<td>{{ obj['hits']['N']}}</td>
			</tr>
			{% endfor %}
		</tbody>
	</table>
</div>

<div class="graph" id="graph" style="width: 500px; height: 500px; "></div>

<script src="../static/js/charts.js" type="application/javascript"></script>
<script type="text/javascript">
google.charts.load('current', { 'packages': ['corechart'] });
google.charts.setOnLoadCallback(drawChart);

function drawChart() {
    var data = google.visualization.arrayToDataTable([
				['Short URL', 'Hits'],
				{% for obj in url %}
			    ['{{ obj['short_url']['S'] }}', {{ obj['hits']['N'] }}],
        		{% endfor %}
		        ]);

	var options = {
		title: 'Statistics Per URL',
		is3D: true
	};

	var chart = new google.visualization.PieChart(document.getElementById('graph'));
	chart.draw(data, options);
}
</script>
</div>
</div>
{% endblock %}